# 第十章：while循环和do-while循环

在前几章的学习中，我们不仅掌握了程序“从上到下”的顺序执行逻辑，还学习了for循环这一实现重复执行需求的工具，它在循环次数明确的场景下非常实用。但在实际编程中，还有很多循环次数不确定的情况：比如验证用户输入是否正确直到输入合法为止、根据用户操作选择是否继续循环等。这时，仅靠for循环就不够灵活了，我们还需要掌握while循环和do-while循环这两种核心循环语句。

循环就像我们日常生活中“每天早上起床→刷牙→洗脸”的重复流程，只要满足“是早上”这个条件，就会重复执行这一系列动作。C++里提供了多种循环语句，今天我们重点学习两种基础且常用的：while循环和do-while循环。

## 10.1 先搞懂：什么是while循环？

while循环的核心逻辑是“先判断条件，再执行循环体”——就像我们去公园跑步，先确认“今天是否需要跑步”（条件判断），如果需要（条件成立），就开始跑步（执行循环内容）；跑完一次后，再重新判断条件，只要条件还成立，就继续跑，直到条件不成立为止，循环结束。

用通俗的话总结：**满足条件才执行，不满足就跳过**。

### 10.1.1 while循环的语法结构

while循环的语法格式非常清晰，固定写法如下：

```cpp
while (循环条件)
{
    // 循环体：需要重复执行的代码块
    语句1;
    语句2;
    ...
}
```

我们逐句拆解这个结构，就像拆解之前的“Hello World”程序一样：

- **while**：是C++中的循环关键字，专门用来定义while循环，告诉编译器“这里开始是一个while循环”。
- **(循环条件)**：括号里必须是一个“布尔值”（真或假），也就是能判断“是”或“否”的表达式。比如“i < 10”“score > 60”等。编译器会先判断这个条件：如果条件为真（非0），就执行大括号里的循环体；如果条件为假（0），就直接跳过循环体，执行循环后面的代码。
- **{ }**：这对大括号是“循环体”的边界，里面包裹的是需要重复执行的代码。注意：如果循环体里只有**一条语句**，大括号可以省略，但为了代码可读性，建议无论多少条语句都加上大括号。
- **循环体内部的关键操作**：循环体里必须有能让“循环条件逐渐变为假”的语句，否则循环会一直执行下去，变成“死循环”（比如永远跑步停不下来，电脑会一直占用资源，直到程序强制关闭）。

### 10.1.2 实战：用while循环输出1到5

光看语法太抽象，我们用一个简单的案例实操——让程序连续输出1、2、3、4、5。按照“先判断，再执行”的逻辑，步骤如下：

1. 定义一个变量i，初始值设为1（循环的起始点）；
2. 判断i是否小于等于5（循环条件：i ≤ 5）；
3. 如果条件成立，输出i的值，然后让i加1（让条件逐渐变假）；
4. 重复步骤2-3，直到i变成6，此时i ≤ 5不成立，循环结束。

对应的代码如下，我们依然用Dev-C++来编写：

```cpp
#include <iostream>
using namespace std;

int main()
{
    int i = 1;  // 1. 初始化循环变量，设定起始值
    while (i <= 5)  // 2. 判断循环条件
    {
        cout << i << " ";  // 3. 循环体：输出i的值，加空格让结果更整齐
        i++;  // 4. 循环变量自增，关键！让条件逐渐不成立
    }
    return 0;
}
```

【操作步骤】：新建.cpp文件，复制上面的代码，保存后编译运行。你会看到黑色窗口中输出：**1 2 3 4 5**，完美实现了重复输出的需求。

我们再梳理一下循环的执行过程，帮你彻底理解：

- 第一次判断：i=1，1≤5成立 → 输出1 → i变成2；
- 第二次判断：i=2，2≤5成立 → 输出2 → i变成3；
- 第三次判断：i=3，3≤5成立 → 输出3 → i变成4；
- 第四次判断：i=4，4≤5成立 → 输出4 → i变成5；
- 第五次判断：i=5，5≤5成立 → 输出5 → i变成6；
- 第六次判断：i=6，6≤5不成立 → 循环结束。

## 10.2 再学习：do-while循环

了解了while循环，再来看它的“兄弟”——do-while循环。两者核心区别只有一个：**do-while循环是“先执行循环体，再判断条件”**。

还是用跑步的例子类比：do-while循环就像“不管今天要不要跑步，先跑一次再说，跑完再判断要不要继续跑”。也就是说，无论条件是否成立，do-while循环的**循环体至少会执行一次**——这是它和while循环最本质的区别。

### 10.2.1 do-while循环的语法结构

do-while循环的语法格式如下，注意和while循环的区别：

```cpp
do
{
    // 循环体：需要重复执行的代码块
    语句1;
    语句2;
    ...
} while (循环条件);  // 注意：这里有一个分号结尾！
```

拆解说明：

- **do**：循环关键字，告诉编译器“先执行后面的循环体”。
- **{ }**：循环体，里面是需要重复执行的代码，无论条件是否成立，都会先执行一次。
- **while (循环条件);**：执行完一次循环体后，再判断条件。如果条件为真，就回到do后面继续执行循环体；如果条件为假，循环结束。**注意末尾的分号不能漏**，这是do-while循环的语法要求，漏写会报错。

### 10.2.2 实战：用do-while循环实现“输入验证”

do-while循环最适合的场景是“需要至少执行一次循环体”的情况，比如“用户输入验证”——要求用户输入1-100之间的分数，直到输入合法为止。因为无论用户第一次输入是否合法，都需要先让用户输入一次（循环体至少执行一次），所以用do-while循环最合适。

案例代码如下：

```cpp
#include <iostream>
using namespace std;

int main()
{
    int score;  // 存储用户输入的分数
    do
    {
        cout << "请输入1-100之间的分数：";
        cin >> score;  // 读取用户输入
        // 判断输入是否合法，如果不合法，提示用户重新输入
        if (score < 1 || score > 100)
        {
            cout << "输入错误！请重新输入。" << endl;
        }
    } while (score < 1 || score > 100);  // 条件：输入不合法就继续循环
    
    cout << "你输入的合法分数是：" << score << endl;
    return 0;
}
```

【操作步骤】：新建.cpp文件，复制代码并运行，我们测试两种情况：

1. 第一次就输入合法分数（比如85）：程序先执行循环体（提示输入→读取85），然后判断条件（85<1或85>100？不成立），循环结束，输出合法分数。
2. 第一次输入不合法分数（比如150）：程序先执行循环体（提示输入→读取150→提示错误），然后判断条件（150<1或150>100？成立），回到do后面继续执行循环体，直到输入1-100之间的数（比如90），循环才结束。

这个案例能明显体现do-while循环的优势：无论条件是否成立，都能保证用户至少输入一次，完美满足“输入验证”的需求。如果换成while循环，第一次判断条件（此时score未初始化，值是随机的），可能会出现逻辑错误，反而麻烦。

## 10.3 关键对比：while循环 vs do-while循环

为了让你更清晰地分清两者的区别，我们用表格总结核心要点：

| 对比维度       | while循环                                                    | do-while循环                                                 |
| :------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| 执行逻辑       | 先判断条件，再执行循环体                                     | 先执行循环体，再判断条件                                     |
| 循环体执行次数 | 可能执行0次（条件一开始就不成立）                            | 至少执行1次                                                  |
| 语法标志       | while(条件) { ... }（无末尾分号）                            | do { ... } while(条件);（末尾必须加分号）                    |
| 适用场景       | 循环次数不确定，可能一次都不执行（比如根据用户选择决定是否循环） | 循环次数不确定，但必须至少执行一次（比如输入验证、菜单选择） |

## 10.4 常见易错点提醒

循环是初学者容易出错的知识点，尤其是以下几个问题，一定要重点注意：

- **忘记初始化循环变量**：比如while循环中，直接写“while(i < 10)”，但没定义i或没给i赋值（int i; 没写i=1;），此时i的值是随机的，条件判断结果不确定，程序可能出错或进入死循环。
- **循环体中缺少“更新循环变量”的语句**：比如while循环中只写了“cout << i;”，没写“i++;”，此时i的值永远不变，条件会一直成立，变成死循环（程序卡住，只能强制关闭）。
- **do-while循环漏写末尾分号**：这是语法错误！do-while循环的格式要求“while(条件);”末尾必须加分号，漏写会导致编译器报错，一定要记住。
- **循环条件书写错误**：比如把“i <= 10”写成“i = 10”（赋值符号写成等于符号），此时条件永远为真（因为i=10是赋值语句，结果为10，非0即真），会进入死循环。记住：判断是否相等用“==”，赋值用“=”。
- **大括号使用不当**：当循环体有多条语句时，忘记加大括号，此时编译器只会把第一条语句当作循环体，后面的语句不会重复执行。比如：

```cpp
// 错误写法：循环体有多条语句却没加括号
int i = 1;
while (i <= 5)
    cout << i << " ";
    i++;  // 这条语句不在循环体内，i永远是1，死循环！
```

正确写法是加上大括号，把两条语句都包含在循环体内。

## 10.5 小试牛刀：动手修改循环程序

学会了两种循环，我们来做两个小练习，巩固一下知识点：

1. **练习1**：修改10.1.2节的while循环代码，让程序输出10到1（倒序输出）。提示：循环变量i初始值设为10，条件设为i ≥ 1，循环体中让i减1（i--）。
2. **练习2**：用do-while循环实现“菜单选择”——程序先显示菜单（1. 查看信息 2. 退出），让用户输入选择；如果输入1，提示“查看信息中...”，然后回到菜单；如果输入2，退出循环。提示：循环条件是“选择 != 2”。

尝试自己写出代码，然后编译运行测试。如果遇到问题，先检查是否有上面提到的易错点，再对照循环的执行逻辑一步步排查。

## 10.6 本章小结

本章我们学习了两种基础循环：while循环和do-while循环。核心要点总结如下：

- 循环的作用是“重复执行一段代码”，解决需要多次重复的编程需求；
- while循环：先判断条件，再执行循环体，可能执行0次；
- do-while循环：先执行循环体，再判断条件，至少执行1次；
- 编写循环时，要注意“初始化循环变量、判断循环条件、更新循环变量”三个关键步骤，避免死循环和语法错误。

循环是编程中非常核心的逻辑结构，后续学习数组、函数等知识点时都会用到。我们已经学习了for循环，本章又掌握了while循环和do-while循环，这三种循环各有适用场景，灵活运用它们能帮你解决更多复杂的编程问题。在实际开发中，可根据循环次数是否确定、是否需要至少执行一次等需求，选择最合适的循环语句，提升代码的效率和可读性！
