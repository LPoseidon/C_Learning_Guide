# 第六章：运算符的“规则手册”

在编程的世界里，运算符就像是“案件当事人”，而代码的执行顺序则是“断案结果”。如果没有明确的规则，程序就会像乱了套的法庭一样，得出荒谬的结论——比如把`1 + 2 * 3`算成9（正确答案是7），或者把`3 > 2 == 1`判成`false`（正确答案是`true`）。这一章，我们就化身“编程判官”，手握“运算符规则手册”，搞懂运算符的“家族关系”和“断案优先级”，让每段代码都“判得明、算得对”。

## 6.1 第一步：认清运算符“家族成员”

在断案之前，得先认识所有“当事人”。C++的运算符家族庞大，但常用的可以分为五大类，就像法庭里的不同角色，各司其职。

### 6.1.1 算术运算符：“计算小能手”

算术运算符负责处理数学运算，是最基础的“当事人”。我们早在小学就认识了它们的“近亲”，编程里的用法基本一致：

| 运算符 | 作用                 | 例子                | 结果    |
| :----- | :------------------- | :------------------ | :------ |
| `+`    | 加法/正号            | `3 + 5` / `+2`      | 8 / 2   |
| `-`    | 减法/负号            | `10 - 4` / `-3`     | 6 / -3  |
| `*`    | 乘法                 | `2 * 6`             | 12      |
| `/`    | 除法（整数除法取商） | `7 / 2` / `7.0 / 2` | 3 / 3.5 |
| `%`    | 取余（只能用于整数） | `7 % 2` / `10 % 3`  | 1 / 1   |

注意：整数除法会“舍弃小数部分”，比如`7 / 2`得3而不是3.5；取余运算的结果符号和被除数一致，比如`-7 % 2`得-1。

### 6.1.2 赋值运算符：“结果搬运工”

赋值运算符负责把“计算结果”搬到变量里，最核心的是`=`，还有简化版的“复合赋值运算符”：

| 运算符         | 等价写法     | 例子                  |
| :------------- | :----------- | :-------------------- |
| `=`            | 无           | `a = 5`（把5赋值给a） |
| `+=`           | `a = a + b`  | `a += 3`（a = a + 3） |
| `-=`           | `a = a - b`  | `a -= 2`（a = a - 2） |
| `*=`/`/=`/`%=` | 类似上述逻辑 | `a *= 4`（a = a * 4） |

### 6.1.3 关系运算符：“大小比较官”

关系运算符负责判断两个值的“大小关系”，结果是`true`（真）或`false`（假），就像法庭里的“是非判断”：

| 运算符 | 含义                   | 示例     | 结果（假设a=5，b=3） |
| ------ | ---------------------- | -------- | -------------------- |
| `>`    | 大于                   | `a > b`  | `true`               |
| `<`    | 小于                   | `a < b`  | `false`              |
| `>=`   | 大于等于               | `a >= 5` | `true`               |
| `<=`   | 小于等于               | `b <= 2` | `false`              |
| `==`   | 等于（注意是两个等号） | `a == 5` | `true`               |
| `!=`   | 不等于                 | `a != b` | `true`               |

**注意**：`==`是“判断等于”，而`=`是“赋值”，两者不能混淆！如果误写为`if (a = 3)`，程序会把3赋值给a，然后将a的值（非0）视为`true`，导致逻辑错误。

### 6.1.4 逻辑运算符：“组合判断官”

逻辑运算符用于组合多个条件，就像生活中的“并且”“或者”“不”：

| 运算符 | 作用           | 示例                  | 结果（假设a=5，b=3） |
| :----- | :------------- | :-------------------- | :------------------- |
| `!`    | 逻辑非（取反） | `!(a > b)`            | `false`              |
| `&&`   | 逻辑与（并且） | `(a > b) && (a == 5)` | `true`               |
| `||`   | 逻辑或（或者） | `(a < b) || (a == 5)` | `true`               |

### 6.1.5 自增与自减运算符：“快速调整员”

自增和自减运算符用于快速调整变量的值：

| 运算符 | 作用  | 示例           | 结果（假设a=5） |
| :----- | :---- | :------------- | :-------------- |
| `++`   | 自增1 | `++a` 或 `a++` | 6               |
| `--`   | 自减1 | `--a` 或 `a--` | 4               |

**注意**：`++a`和`a++`的区别在于，`++a`是先自增再使用，`a++`是先使用再自增。同理，`--a`是先自减再使用，`a--`是先使用再自减。

## 6.2 第二步：搞懂运算符的“家族关系”

运算符之间也有“家族关系”，这种关系决定了它们的优先级。优先级高的运算符会先执行，就像在法庭上，法官先听“重要证人”的证词一样。C++的运算符优先级如下：

1. **括号**：`()`（最高优先级，可以改变运算顺序）
2. **一元运算符**：`!`、`++`、`--`
3. **算术运算符**：`*`、`/`、`%`（先算乘除取余）
4. **算术运算符**：`+`、`-`（再算加减）
5. **关系运算符**：`>`、`<`、`>=`、`<=`、`==`、`!=`
6. **逻辑运算符**：`&&`（逻辑与）
7. **逻辑运算符**：`||`（逻辑或）
8. **赋值运算符**：`=`、`+=`、`-=`、`*=`、`/=`、`%=`（最低优先级）

## 6.3 第三步：实战演练，让代码“判得明、算得对”

### 6.3.1 示例1：计算表达式

假设我们有这样一个表达式：`3 + 4 * 2 > 10 && 5 == 5`

1. **先算乘法**：`4 * 2 = 8`
2. **再算加法**：`3 + 8 = 11`
3. **比较大小**：`11 > 10`（结果为`true`）
4. **比较等号**：`5 == 5`（结果为`true`）
5. **逻辑与**：`true && true`（结果为`true`）

所以，最终结果是`true`。

### 6.3.2 示例2：自增与自减

假设我们有变量`int a = 5;`，执行以下代码：

```cpp
int b = ++a; // a先自增为6，然后赋值给b，所以b=6
int c = a++; // a先赋值给c，然后自增为7，所以c=6
```

最终，`a=7`，`b=6`，`c=6`。

## 6.4 第四步：常见错误及避免方法

### 6.4.1 错误1：混淆`=`和`==`

**错误示例**：

```cpp
if (a = 3) {
    cout << "a等于3" << endl;
}
```

**问题**：`a = 3`是赋值操作，而不是比较操作。这会导致`a`被赋值为3，然后条件判断为`true`。

**正确写法**：

```cpp
if (a == 3){
cout << "a等于3" << endl;
}
```

### 6.4.2 错误2：忽略优先级

**错误示例**：

```cpp
int result = 3 + 4 * 2 / 2 - 1; // 你可能以为结果是4，但实际结果是6
```

**问题**：没有考虑运算符优先级，乘除法先于加减法执行。

**正确理解**：

1. 先算`4 * 2 = 8`
2. 再算`8 / 2 = 4`
3. 然后`3 + 4 = 7`
4. 最后`7 - 1 = 6`

### 6.4.3 错误3：误用自增/自减

**错误示例**：

```cpp
int a = 5;
int b = a++ + ++a; // 你可能以为结果是12，但实际结果是13
```

**问题**：没有理解`a++`和`++a`的区别。

**正确理解**：

1. `a++`先使用`a`的值（5），然后`a`自增为6。
2. `++a`先将`a`自增为7，然后使用`a`的值。
3. 所以`b = 5 + 7 = 12`。

## 6.5 第五步：小试牛刀，自己动手写代码

### 练习1：计算表达式

编写一个程序，计算以下表达式的值并输出结果：

```cpp
int a = 3;
int b = 4;
int c = 2;
int result = (a + b) * c / 2;
```

### 练习2：逻辑判断

编写一个程序，判断以下条件是否成立，并输出结果：

```cpp
int x = 10;
int y = 20;
bool condition = (x > 5) && (y < 30) || (x == y);
```

### 练习3：自增与自减

编写一个程序，演示`++a`和`a++`的区别，并输出结果：

```cpp
int a = 5;
int b = ++a; // b=6, a=6
int c = a++; // c=6, a=7
```

## 6.6 第六步：本章小结

通过这一章的学习，我们认识了运算符的“家族成员”，搞懂了它们的“家族关系”和优先级，还通过实战演练学会了如何正确使用它们。运算符是编程中的“基础工具”，掌握它们的规则，就能让代码“判得明、算得对”。下一章，我们将继续探索更多有趣的编程知识，让程序变得更强大！