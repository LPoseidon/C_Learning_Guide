# 第十一章：数组

在前几章的学习中，我们已经掌握了变量和循环的使用。当需要存储单个数据时，用int、float、char等基本数据类型定义变量就足够了，比如用int score存储一个学生的分数，用char ch存储一个字符。但在实际编程场景中，经常会遇到需要存储“一组相同类型数据”的情况：比如存储一个班级50名学生的分数、存储10个整数的总和、存储一个单词的所有字符。如果此时用单个变量逐个存储，不仅需要定义大量变量（如score1、score2、...、score50），代码会变得冗长繁琐，后续处理（如计算平均分、查找最高分）也会非常麻烦。

为了解决这个问题，C++提供了“数组”这一数据结构。数组就像一个“有序的储物架”，可以将多个相同类型的数据整齐地存储在连续的“格子”里，每个格子对应一个数据，我们只需通过“格子编号”（索引）就能快速找到并操作对应的数据，极大地简化了对批量数据的处理。本章我们就来系统学习数组的基本使用。

## 11.1 先搞懂：什么是数组？

数组是**一组具有相同数据类型的有序数据的集合**，这些数据在内存中占用连续的存储空间。我们可以用生活中的“学生储物柜”来类比数组：

- 储物柜整体有一个统一的名字（比如“班级储物柜”）——对应数组名；
- 每个储物柜有唯一的编号（比如1号、2号、...、50号）——对应数组的索引（下标）；
- 每个储物柜只能存放特定类型的物品（比如只能放书包）——对应数组中所有元素的数据类型相同；
- 储物柜是连续排列的——对应数组元素在内存中连续存储。

用通俗的话总结：数组就是“同类型数据的有序容器”，核心作用是**批量存储和管理相同类型的多个数据**。

### 11.1.1 数组的核心要素

一个完整的数组包含三个核心要素，缺一不可：

1. **数据类型**：数组中所有元素必须是同一种数据类型，比如int数组只能存整数，char数组只能存字符，float数组只能存浮点数。
2. **数组名**：数组的名称，遵循变量命名规则（由字母、数字、下划线组成，不能以数字开头，不能是关键字），用于标识整个数组。
3. **数组长度**：数组中能存储的元素个数，必须是正整数（常量），一旦定义，长度就不能修改（C++中的普通数组是“静态数组”）。

## 11.2 数组的定义与初始化

和变量一样，数组在使用前必须先定义，明确其数据类型、数组名和长度；也可以在定义时直接给数组元素赋值（初始化），避免元素值为随机数。

### 11.2.1 数组的定义格式

C++中数组的定义格式有两种，最常用的是第一种：

```cpp
// 格式1：推荐使用，清晰直观
数据类型 数组名[数组长度];

// 格式2：不推荐，容易混淆数组名和指针（后续章节讲解）
数据类型 [数组长度] 数组名;
```

示例讲解：定义一个能存储5个整数的数组

```cpp
int scores[5];  // 正确：数据类型int，数组名scores，长度5，可存5个整数
// 解读：
// 1. int：数组元素是整数类型；
// 2. scores：数组名，符合变量命名规则；
// 3. [5]：数组长度为5，即有5个元素，索引从0到4（重点注意！）。
```

⚠️ 关键提醒：C++数组的索引（下标）**从0开始**，而不是从1开始！比如长度为5的数组，索引范围是0~4（对应5个元素），分别对应数组的第1个到第5个元素。如果访问索引5，就会超出数组范围（数组越界），导致程序出错。

### 11.2.2 数组的初始化方式

数组初始化是指在定义数组时，直接给部分或全部元素赋值。常见的初始化方式有4种，根据需求选择：

1. **完全初始化**：给数组的所有元素逐一赋值，赋值个数等于数组长度。
2. **部分初始化**：只给前几个元素赋值，未赋值的元素会自动初始化为0（数值型数组）或空字符（char数组）。
3. **省略数组长度的初始化**：定义数组时不写长度，编译器会根据赋值的元素个数自动计算数组长度。
4. **字符数组的初始化**：char数组（字符串数组）除了用大括号赋值，还可以直接用字符串常量赋值（注意字符串末尾会自动添加'\0'作为结束标志）。

### 11.2.3 初始化的注意事项

- 初始化时，赋值个数不能超过数组长度，否则会报错（数组越界）。比如`int scores[5] = {90, 85, 95, 88, 92, 89};`（赋值6个值，长度5），编译器会提示错误。
- 不能只给部分元素赋值后再省略长度，比如`int scores[] = {90, 85};`是正确的（长度2），但如果想定义长度5只给前2个赋值，必须写长度：`int scores[5] = {90, 85};`。
- 静态数组的长度必须是常量，不能用变量定义。比如`int n = 5; int scores[n];`是错误的（n是变量），正确写法是`const int n = 5; int scores[n];`（n是常量）。

## 11.3 数组元素的访问与修改

数组元素的访问通过“数组名[索引]”的方式实现，索引就是元素在数组中的“位置编号”（从0开始）。访问到元素后，既可以读取元素的值，也可以修改元素的值。

### 11.3.1 访问与修改的基本操作

示例：定义一个数组，访问并修改其中的元素

```cpp
#include <iostream>
using namespace std;

int main()
{
    int scores[5] = {90, 85, 95, 88, 92};  // 定义并初始化数组
    
    // 1. 访问元素：读取值
    cout << "第1个元素（索引0）：" << scores[0] << endl;  // 输出90
    cout << "第3个元素（索引2）：" << scores[2] << endl;  // 输出95
    
    // 2. 修改元素：重新赋值
    scores[1] = 88;  // 将索引1的元素（原85）修改为88
    scores[4] = 95;  // 将索引4的元素（原92）修改为95
    
    // 3. 再次访问，查看修改结果
    cout << "修改后第2个元素（索引1）：" << scores[1] << endl;  // 输出88
    cout << "修改后第5个元素（索引4）：" << scores[4] << endl;  // 输出95
    
    return 0;
}
```

【操作步骤】：新建.cpp文件，复制代码编译运行，输出结果如下：

```Plain
第1个元素（索引0）：90
第3个元素（索引2）：95
修改后第2个元素（索引1）：88
修改后第5个元素（索引4）：95
```

结论：数组元素的访问和修改非常灵活，只要知道正确的索引，就能直接操作对应的元素。

### 11.3.2 结合循环访问数组（重点）

当数组长度较大时（比如100个元素），逐个访问元素会非常繁琐。此时，我们可以结合前一章学习的循环语句（for、while）来批量访问数组元素，效率极高。其中，for循环最适合遍历数组（因为循环次数明确，就是数组长度）。

示例：用for循环遍历数组，计算5个学生的平均分

```cpp
#include <iostream>
using namespace std;

int main()
{
    int scores[5] = {90, 85, 95, 88, 92};
    int sum = 0;  // 存储总分
    double avg = 0.0;  // 存储平均分（用double保证精度）
    
    // for循环遍历数组：i从0到4（索引范围），对应5个元素
    for (int i = 0; i < 5; i++)
    {
        sum += scores[i];  // 累加每个元素的值到sum
        cout << "第" << (i + 1) << "个学生分数：" << scores[i] << endl;
    }
    
    avg = sum / 5.0;  // 计算平均分，用5.0避免整数除法
    cout << "5个学生的总分：" << sum << endl;
    cout << "5个学生的平均分：" << avg << endl;
    
    return 0;
}
```

【运行结果】：

```Plain
第1个学生分数：90
第2个学生分数：85
第3个学生分数：95
第4个学生分数：88
第5个学生分数：92
5个学生的总分：450
5个学生的平均分：90
```

💡 技巧：遍历数组时，循环变量i通常作为数组的索引，初始值为0，循环条件为`i < 数组长度`，这样就能覆盖所有元素，不会出现越界。

### 11.3.3 数组越界问题（严重易错点）

数组越界是指访问的索引超出了数组的有效索引范围（比如长度为5的数组，访问索引5或-1）。C++编译器不会检查数组越界错误，程序运行时会出现不可预测的结果（比如读取随机值、程序崩溃、修改其他变量的值），一定要严格避免！

```cpp
#include <iostream>
using namespace std;

int main()
{
    int scores[5] = {90, 85, 95, 88, 92};
    
    // 错误：数组长度5，有效索引0-4，访问索引5属于越界
    cout << scores[5] << endl;  // 输出随机值，程序可能出错
    
    return 0;
}
```

⚠️ 避免越界的核心原则：访问数组时，索引必须满足 `0 ≤ 索引 < 数组长度`。在循环遍历数组时，一定要确保循环条件正确（比如`i < 5`而不是`i ≤ 5`）。

## 11.4 数组的常见应用场景

数组常用于批量处理相同类型的数据，以下是两个典型应用场景，帮助你巩固知识点：

### 11.4.1 场景1：查找数组中的最大值

需求：定义一个存储5个整数的数组，找出其中的最大值并输出。

思路：

1. 假设数组第一个元素（索引0）是最大值，存入变量max；
2. 用for循环遍历数组，将每个元素与max比较；
3. 如果当前元素大于max，就更新max为当前元素；
4. 循环结束后，max就是数组中的最大值。

```cpp
#include <iostream>
using namespace std;

int main()
{
    int arr[5] = {12, 45, 7, 33, 56};
    int max = arr[0];  // 假设第一个元素是最大值
    
    for (int i = 1; i < 5; i++)  // 从索引1开始遍历（已比较过索引0）
    {
        if (arr[i] > max)
        {
            max = arr[i];  // 更新最大值
        }
    }
    
    cout << "数组中的最大值：" << max << endl;  // 输出56
    return 0;
}
```

### 11.4.2 场景2：字符数组存储字符串

需求：用char数组存储用户输入的姓名，然后输出“你好，XXX！”。

注意：char数组存储字符串时，要预留一个位置给'\0'结束符，所以数组长度要比最大可能输入的字符数多1。

```cpp
#include <iostream>
using namespace std;

int main()
{
    char name[20];  // 定义长度20的char数组，可存储19个可见字符+1个'\0'
    
    cout << "请输入你的姓名：";
    cin >> name;  // 读取用户输入的字符串，存入name数组（自动添加'\0'）
    
    cout << "你好，" << name << "！" << endl;  // 输出结果
    
    return 0;
}
```

【运行示例】：

```Plain
请输入你的姓名：Zhang San
你好，Zhang！
```

💡 说明：cin读取字符串时，会以空格、回车等分隔符结束，所以如果输入带空格的姓名（如Zhang San），只会读取到第一个空格前的“Zhang”。如果需要读取带空格的字符串，后续会学习更强大的string类。

## 11.5 常见易错点提醒

数组是初学者的重点和难点，以下几个易错点一定要牢记：

- **索引从0开始，不是1**：这是最容易出错的地方！比如长度为5的数组，最后一个元素的索引是4，不是5。
- **数组越界**：访问索引超出有效范围，编译器不报错，但程序运行时会出问题，一定要检查循环条件和索引值。
- **初始化时赋值个数超过长度**：比如`int arr[3] = {1,2,3,4};`，编译器会直接报错，注意赋值个数不能超过数组长度。
- **用变量定义数组长度**：C++静态数组的长度必须是常量，不能用变量定义，比如`int n=5; int arr[n];`是错误的，正确写法是`const int n=5; int arr[n];`。
- **字符数组存储字符串时忘记预留'\0'位置**：比如存储“Hello”（5个字符），数组长度至少为6（5个字符+1个'\0'），否则会导致字符串处理错误。

## 11.6 小试牛刀：动手练习

通过以下练习巩固数组的知识点，尝试自己编写代码并运行测试：

1. **练习1**：定义一个长度为10的int数组，初始化前5个元素为1、2、3、4、5，其余元素自动为0。用for循环遍历数组，输出所有元素的值。
2. **练习2**：定义一个存储6个整数的数组，用for循环让用户输入6个整数存入数组，然后计算数组中所有元素的总和并输出。
3. **练习3**：用char数组存储字符串“C++ Programming”，然后用for循环遍历数组，输出每个字符（提示：数组长度至少为15，包含'\0'）。

## 11.7 本章小结

本章我们学习了数组的基本概念和使用方法，核心要点总结如下：

- 数组是“同类型数据的有序集合”，用于批量存储和管理相同类型的多个数据，元素在内存中连续存储。
- 数组的核心要素：数据类型、数组名、数组长度（静态数组长度固定，必须是常量）。
- 数组索引从0开始，有效范围是`0 ≤ 索引 < 数组长度`，访问超出范围会导致数组越界。
- 数组的初始化方式有完全初始化、部分初始化、省略长度初始化，未初始化的元素自动为0（数值型）或'\0'（字符型）。
- 结合循环（尤其是for循环）可以高效遍历数组，实现批量数据处理（如计算总和、查找最大值）。
- 常见易错点：索引从0开始、数组越界、用变量定义长度等，编写代码时要重点规避。

